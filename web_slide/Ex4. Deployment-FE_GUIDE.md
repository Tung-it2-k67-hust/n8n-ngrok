# DEVELOPER DECISION GUIDE: Ex4. Deployment-FE.pdf

> Generated by OpenRouter (xiaomi/mimo-v2-flash:free) on 2026-01-06 17:40:55



<!-- CHUNK 1-8 -->

# DEVELOPER DECISION GUIDE: Triển Khai Frontend Lên Firebase

--------------------------------
SECTION 1: CORE MENTAL MODEL
--------------------------------

**Firebase Hosting (Dịch vụ lưu trữ web)**
Dịch vụ lưu trữ website tĩnh (HTML, CSS, JS) của Google, cung cấp SSL miễn phí, CDN toàn cầu và tích hợp sẵn CI/CD. Nó hoạt động như một "tấm áp phích" đám mây cho mã nguồn của bạn.

**Mental Model: Bức tranh toàn cảnh**
1. **Máy tính của bạn (Localhost):** Nơi bạn viết code. Thư mục `public` chứa file `index.html`.
2. **Firebase CLI (Công cụ lệnh):** Chiếc cầu nối. Bạn dùng lệnh `firebase deploy` để ném khối code từ máy tính lên đám mây.
3. **Firebase Cloud:** Nơi nhận code, lưu trữ và phân phối (CDN) đến người dùng cuối.

**Tại sao tốt hơn cách làm truyền thống?**
*   **Truyền thống (FTP/WebDAV):** Phải cài phần mềm, upload file thủ công, dễ sai, không có version control.
*   **Firebase:** Một dòng lệnh `deploy` = Toàn bộ hệ thống tự động cập nhật, rollback dễ dàng, có sẵn HTTPS (không cần cài SSL thủ công).

--------------------------------
SECTION 2: DECISION TABLES (VERY IMPORTANT)
--------------------------------

| Tình huống sử dụng | Nên dùng gì | Tại sao (Tại sao - EN term + VI explanation) | Sai lầm thường gặp |
| :--- | :--- | :--- | :--- |
| **Web đơn giản (HTML/CSS/JS thuần)** | `firebase init hosting` -> `public` | **Static Hosting:** Tiết kiệm chi phí, load nhanh vì không cần server xử lý (No server-side processing). | Để file index.html ở thư mục gốc thay vì trong `public`. |
| **Web có nhiều trang (SPA)** | Chọn `Y` tại **Configure as a single-page app** | **Rewrites:** Giúp server trả về index.html cho mọi URL không t tồn tại để Router của FE hoạt động (Client-side Routing). | Chọn `N`, dẫn đến trang 404 khi refresh trang con. |
| **Web đã có sẵn project Firebase** | Chọn **Project hiện có** tại bước init | **Re-deployment:** Đảm bảo giữ nguyên thống kê, cài đặt cũ và chỉ cập nhật source code (Preserve configuration). | Tạo project mới lặp lại (Duplicate project) gây lã phí và lộn xộn. |

--------------------------------
SECTION 3: ARCHITECTURE & RELATIONSHIPS
--------------------------------

**Quy trình luồng triển khai (Deployment Flow)**

```text
[ Local Machine ]
  |
  | 1. firebase login
  | 2. firebase init (Cấu hình 1 lần)
  | 3. firebase deploy (Lần sau chỉ cần bước này)
  v
[ Firebase CLI ]
  |
  | Xác thực (Token)
  v
[ Firebase Console (Cloud) ]
  |-> [ Storage ] Lưu file index.html, assets
  |-> [ CDN ] Phân phối file đến người dùng toàn cầu
  v
[ Người dùng cuối (User) ]
  Truy cập qua: https://<project-id>.web.app
```

**Lưu ý về Frontend & Backend (BE)**
*   FE (Firebase) và BE (Render/Heroku) là **hai hệ thống riêng biệt**.
*   FE gọi API sang BE thông qua `fetch` hoặc `axios`.
*   **Yêu cầu:** FE không cần biết BE deploy ở đâu, chỉ cần biết **URL API** và đảm bảo CORS cho phép FE gọi sang BE.

--------------------------------
SECTION 4: CODE PATTERNS (READY TO USE)
--------------------------------

### Pattern 1: Chuẩn bị cấu trúc project chuẩn
**Khi nào dùng:** Khi bắt đầu dự án mới để chuẩn bị cho việc deploy lên Firebase.

**Tại sao đúng:** Firebase mặc định tìm file `index.html` trong thư mục `public`. Cấu trúc đúng giúp `firebase init` chạy đúng ngọac, tránh lỗi cấu hình.

**Code Demo hoàn chỉnh:**
```bash
# Cấu trúc thư mục
frontend/
├── public/
│   ├── index.html      # File chính
│   ├── style.css       # Style
│   └── script.js       # Logic
├── .gitignore          # (Tùy chọn) Bỏ qua node_modules
└── (Các file cấu hình firebase sẽ được tạo tự động sau)
```

### Pattern 2: Chuẩn bị file index.html kết nối API
**Khi nào dùng:** Khi cần gọi API Backend (Render) từ Frontend (Firebase).

**Tại sao đúng:** Tránh ghardcode URL API. Dùng biến môi trường hoặc URL config để dễ đổi link BE mà không sửa code FE.

**Code Demo (`public/index.html`):**
```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>User CRUD</title>
    <!-- Link CSS nếu có -->
</head>
<body>
    <h1>Danh sách Users</h1>
    <div id="user-list"></div>

    <script>
        // THAY ĐỔI URL BE CỦA BẠN Ở ĐÂY
        const API_URL = "https://your-be-render-url.com/users";

        async function fetchUsers() {
            try {
                const response = await fetch(API_URL);
                if (!response.ok) throw new Error("Network response was not ok");
                const users = await response.json();
                console.log(users);
                // Code render UI vào #user-list ở đây...
            } catch (error) {
                console.error("Lỗi khi gọi API:", error);
            }
        }

        // Gọi hàm khi load trang
        fetchUsers();
    </script>
</body>
</html>
```

--------------------------------
SECTION 5: ANTI-PATTERNS & WARNINGS
--------------------------------

1.  **Lệnh `firebase init` sai thư mục:**
    *   **Nguy hiểm:** Nếu chạy lệnh này trong thư mục `public` hoặc `frontend/public`, cấu trúc file sẽ bị rối, firebase không tìm thấy file chính xác, gây lỗi deploy.
    *   **Đúng:** Luôn chạy trong thư mục gốc chứa folder `public` (ví dụ: thư mục `frontend`).

2.  **Overwrite file index.html (Bước 5):**
    *   **Nguy hiểm:** Nếu gõ `Y` tại câu hỏi "File public/index.html already exists. Overwrite?", file code hiện tại của bạn sẽ bị xóa trắng.
    *   **Đúng:** Luôn gõ `N` (No) nếu bạn đã có code sẵn trong file đó.

3.  **Quên cấu hình "Single-page app":**
    *   **Nguy hiểm:** Nếu chọn `N` cho "Configure as a single-page app", khi người dùng truy cập `/profile` (ví dụ) hoặc refresh trang con, Firebase sẽ báo lỗi 404 vì server nghĩ không có file `/profile.html`.
    *   **Đúng:** Luôn chọn `Y` cho các ứng dụng React, Vue, Angular, Vanilla JS dùng Routing.

--------------------------------
SECTION 6: MASTER CHEAT SHEET
--------------------------------

**Quy trình nhanh (Quyết định logic):**

*   **IF** (Project mới hoàn toàn) -> Chọn `Create a new project`.
*   **ELSE IF** (Project đã t tồn tại) -> Chọn `Use an existing project`.
*   **IF** (Có file `index.html` sẵn) -> Trả lời `N` khi hỏi overwrite.
*   **IF** (App dùng Router) -> Trả lời `Y` khi hỏi SPA.

**Top 5 điều cần nhớ:**

1.  **Login:** `firebase login` (Làm 1 lần).
2.  **Init:** `firebase init hosting` (Cấu hình thư mục chứa code là `public`).
3.  **Deploy:** `firebase deploy` (Lệnh xuất bản).
4.  **Link:** Kết quả sẽ là `https://<ten-du-an>.web.app`.
5.  **Lỗi 404:** Chắc chắn đã chọn `Y` cho **SPA** và thư mục public đúng.